var kt=Object.create;var de=Object.defineProperty,Ft=Object.defineProperties,qt=Object.getOwnPropertyDescriptor,Nt=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var Ke=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var We=(r,e)=>(e=Symbol[r])?e:Symbol.for("Symbol."+r),Y=r=>{throw TypeError(r)};var pe=(r,e,t)=>e in r?de(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,X=(r,e)=>{for(var t in e||(e={}))Ke.call(e,t)&&pe(r,t,e[t]);if(ee)for(var t of ee(e))Ue.call(e,t)&&pe(r,t,e[t]);return r},me=(r,e)=>Ft(r,Nt(e)),i=(r,e)=>de(r,"name",{value:e,configurable:!0});var Ge=(r,e)=>{var t={};for(var o in r)Ke.call(r,o)&&e.indexOf(o)<0&&(t[o]=r[o]);if(r!=null&&ee)for(var o of ee(r))e.indexOf(o)<0&&Ue.call(r,o)&&(t[o]=r[o]);return t};var f=r=>{var e;return[,,,kt((e=r==null?void 0:r[We("metadata")])!=null?e:null)]},ze=["class","method","getter","setter","accessor","field","value","get","set"],Q=r=>r!==void 0&&typeof r!="function"?Y("Function expected"):r,Bt=(r,e,t,o,s)=>({kind:ze[r],name:e,metadata:o,addInitializer:l=>t._?Y("Already initialized"):s.push(Q(l||null))}),Ht=(r,e)=>pe(e,We("metadata"),r[3]),g=(r,e,t,o)=>{for(var s=0,l=r[e>>1],u=l&&l.length;s<u;s++)e&1?l[s].call(t):o=l[s].call(t,o);return o},h=(r,e,t,o,s,l)=>{var u,n,a,p,m,c=e&7,C=!!(e&8),b=!!(e&16),d=c>3?r.length+1:c?C?1:2:0,w=ze[c+5],T=c>3&&(r[d-1]=[]),I=r[d]||(r[d]=[]),v=c&&(!b&&!C&&(s=s.prototype),c<5&&(c>3||!b)&&qt(c<4?s:{get[t](){return Me(this,l)},set[t](x){return Ve(this,l,x)}},t));c?b&&c<4&&i(l,(c>2?"set ":c>1?"get ":"")+t):i(s,t);for(var E=o.length-1;E>=0;E--)p=Bt(c,t,a={},r[3],I),c&&(p.static=C,p.private=b,m=p.access={has:b?x=>jt(s,x):x=>t in x},c^3&&(m.get=b?x=>(c^1?Me:Mt)(x,s,c^4?l:v.get):x=>x[t]),c>2&&(m.set=b?(x,D)=>Ve(x,s,D,c^4?l:v.set):(x,D)=>x[t]=D)),n=(0,o[E])(c?c<4?b?l:v[w]:c>4?void 0:{get:v.get,set:v.set}:s,p),a._=1,c^4||n===void 0?Q(n)&&(c>4?T.unshift(n):c?b?l=n:v[w]=n:s=n):typeof n!="object"||n===null?Y("Object expected"):(Q(u=n.get)&&(v.get=u),Q(u=n.set)&&(v.set=u),Q(u=n.init)&&T.unshift(u));return c||Ht(r,s),v&&de(s,t,v),b?c^4?l:v:s};var fe=(r,e,t)=>e.has(r)||Y("Cannot "+t),jt=(r,e)=>Object(e)!==e?Y('Cannot use the "in" operator on this value'):r.has(e),Me=(r,e,t)=>(fe(r,e,"read from private field"),t?t.call(r):e.get(r));var Ve=(r,e,t,o)=>(fe(r,e,"write to private field"),o?o.call(r,t):e.set(r,t),t),Mt=(r,e,t)=>(fe(r,e,"access private method"),t);import{PasswordEditor as Vt,PrefixedContext as Kt,initFormType as Ut}from"@serenity-is/corelib";var L=class L extends Kt{constructor(e){if(super(e),!L.init){L.init=!0;var t=Vt;Ut(L,["OldPassword",t,"NewPassword",t,"ConfirmPassword",t])}}};i(L,"ChangePasswordForm"),L.formKey="Serenity.Extensions.ChangePasswordRequest";var Je=L;import{EmailAddressEditor as Wt,PrefixedContext as Gt,initFormType as zt}from"@serenity-is/corelib";var k=class k extends Gt{constructor(e){if(super(e),!k.init){k.init=!0;var t=Wt;zt(k,["Email",t])}}};i(k,"ForgotPasswordForm"),k.formKey="Serenity.Extensions.ForgotPasswordRequest";var Qe=k;import{PasswordEditor as Jt,PrefixedContext as Qt,initFormType as Yt}from"@serenity-is/corelib";var F=class F extends Qt{constructor(e){if(super(e),!F.init){F.init=!0;var t=Jt;Yt(F,["NewPassword",t,"ConfirmPassword",t])}}};i(F,"ResetPasswordForm"),F.formKey="Serenity.Extensions.ResetPasswordRequest";var Ye=F;import{fieldsProxy as Xt}from"@serenity-is/corelib";var S=class S{};i(S,"UserPreferenceRow"),S.idProperty="UserPreferenceId",S.nameProperty="Name",S.localTextPrefix="Common.UserPreference",S.deletePermission="",S.insertPermission="",S.readPermission="",S.updatePermission="",S.Fields=Xt();var Xe=S;import{serviceRequest as Zt}from"@serenity-is/corelib";var Z;(t=>(t.baseUrl="Extensions/UserPreference",t.Methods={Update:"Extensions/UserPreference/Update",Retrieve:"Extensions/UserPreference/Retrieve"},["Update","Retrieve"].forEach(o=>{t[o]=function(s,l,u){return Zt(t.baseUrl+"/"+o,s,l,u)}})))(Z||(Z={}));import{Decorators as cr,DialogTexts as pr,BaseDialog as dr,localText as et}from"@serenity-is/corelib";var be=Object.keys;function $t(r){return typeof r=="boolean"}i($t,"isBoolean");function _t(r){return r&&typeof r.nodeType=="number"}i(_t,"isElement");function ve(r){return typeof r=="string"}i(ve,"isString");function er(r){return typeof r=="number"}i(er,"isNumber");function q(r){return typeof r=="object"?r!==null:$(r)}i(q,"isObject");function $(r){return typeof r=="function"}i($,"isFunction");function tr(r){let{prototype:e}=r;return!!(e&&e.isReactComponent)}i(tr,"isComponentClass");function rr(r){return q(r)&&typeof r.length=="number"&&typeof r.nodeType!="number"}i(rr,"isArrayLike");function he(r,e){if(r)for(let t of be(r))e(r[t],t)}i(he,"forEach");function or(r){return q(r)&&"current"in r}i(or,"isRef");var sr=Symbol.for("jsx-dom:type"),Ze=function(r){return r.ShadowRoot="ShadowRoot",r}(Ze||{});function ir(r){return r!=null&&r[sr]===Ze.ShadowRoot}i(ir,"isShadowRoot");function $e(r){return!$t(r)&&r!=null}i($e,"isVisibleChild");function ye(r){return Array.isArray(r)?r.map(ye).filter(Boolean).join(" "):q(r)?Symbol.iterator in r?ye(Array.from(r)):be(r).filter(e=>r[e]).join(" "):$e(r)?""+r:""}i(ye,"className");var Te=class Te{constructor(e){this.props=e}render(){return null}};i(Te,"Component");var xe=Te;xe.prototype;function nr(r,e,t){e=me(X({},e),{children:t});let o=new r(e),s=o.render();return"ref"in e&&Pe(e.ref,o),s}i(nr,"initComponentClass");function P(r,e){let l=e,{children:t}=l,o=Ge(l,["children"]),s;if(ve(r)){if(s=o.namespaceURI?document.createElementNS(o.namespaceURI,r):document.createElement(r),ur(o,s),Ce(t,s),s instanceof window.HTMLSelectElement&&o.value!=null)if(o.multiple===!0&&Array.isArray(o.value)){let u=o.value.map(n=>String(n));s.querySelectorAll("option").forEach(n=>n.selected=u.includes(n.value))}else s.value=o.value;Pe(o.ref,s)}else if($(r))q(r.defaultProps)&&(o=X(X({},r.defaultProps),o)),s=tr(r)?nr(r,o,t):r(me(X({},o),{children:t}));else throw new TypeError(`Invalid JSX element type: ${r}`);return s}i(P,"jsx");function Pe(r,e){or(r)?r.current=e:$(r)&&r(e)}i(Pe,"attachRef");function Ce(r,e){if(rr(r))ar(r,e);else if(ve(r)||er(r))ge(document.createTextNode(r),e);else if(r===null)ge(document.createComment(""),e);else if(_t(r))ge(r,e);else if(ir(r)){let t=e.attachShadow(r.attr);Ce(r.children,t),Pe(r.ref,t)}}i(Ce,"appendChild");function ar(r,e){for(let t of[...r])Ce(t,e);return e}i(ar,"appendChildren");function ge(r,e){e instanceof window.HTMLTemplateElement?e.content.appendChild(r):e.appendChild(r)}i(ge,"appendChildToNode");function _e(r,e){e==null||e===!1||(Array.isArray(e)?e.forEach(t=>_e(r,t)):ve(e)?r.setAttribute("style",e):q(e)&&he(e,(t,o)=>{o.indexOf("-")===0?r.style.setProperty(o,t):r.style[o]=t}))}i(_e,"style");function lr(r,e,t){switch(r){case"htmlFor":te(t,"for",e);return;case"dataset":he(e,(o,s)=>{o!=null&&(t.dataset[s]=o)});return;case"innerHTML":case"innerText":case"textContent":$e(e)&&(t[r]=e);return;case"dangerouslySetInnerHTML":q(e)&&(t.innerHTML=e.__html);return;case"value":if(e==null||t instanceof window.HTMLSelectElement)return;if(t instanceof window.HTMLTextAreaElement){t.value=e;return}break;case"spellCheck":t.spellcheck=e;return;case"class":case"className":$(e)?e(t):te(t,"class",ye(e));return;case"ref":case"namespaceURI":return;case"style":_e(t,e);return;case"on":case"onCapture":he(e,(o,s)=>{t.addEventListener(s,o,r==="onCapture")});return}if($(e)){if(r[0]==="o"&&r[1]==="n"){let o=r.toLowerCase(),s=o.endsWith("capture");if(o==="ondoubleclick"?o="ondblclick":s&&o==="ondoubleclickcapture"&&(o="ondblclickcapture"),!s&&t[o]===null)t[o]=e;else if(s)t.addEventListener(o.substring(2,o.length-7),e,!0);else{let l;o in window?l=o.substring(2):l=o[2]+r.slice(3),t.addEventListener(l,e)}}}else q(e)?t[r]=e:e===!0?te(t,r,""):e!==!1&&e!=null&&te(t,r,e)}i(lr,"attribute");function te(r,e,t){r.setAttribute(e,t)}i(te,"attr");function ur(r,e){for(let t of be(r))lr(t,r[t],e);return e}i(ur,"attributes");var tt,Se,mr;tt=[cr.registerClass("Serenity.Extensions.BasicProgressDialog")];var H=class H extends(mr=dr){constructor(e){super(e),this.dialogTitle=et("Site.BasicProgressDialog.PleaseWait")}get max(){return parseInt(this.byId("ProgressBar").attr("aria-valuemax"),10)}set max(e){this.byId("ProgressBar").attr("aria-valuemax",(e||100).toString())}get value(){return parseInt(this.byId("ProgressBar").attr("aria-valuenow"),10)}set value(e){this.byId("ProgressBar").attr("aria-valuenow",(e||0).toString()).text(e+" / "+this.max).getNode().style.width=(e||0)/(this.max||100)*100+"%"}get title(){return this.dialogTitle}set title(e){this.dialogTitle=e}getDialogButtons(){return[{text:pr.CancelButton,class:"btn btn-danger",click:i(()=>{var e,t;this.cancelled=!0,(e=this.domNode.closest(".ui-dialog").querySelectorAll(".ui-dialog-buttonpane .ui-button"))==null||e.forEach(o=>{o.setAttribute("disabled","disabled"),o.style.opacity="0.5"}),this.dialogTitle=((t=this.cancelTitle)==null?void 0:t.trim())||et("Site.BasicProgressDialog.CancelTitle")},"click")}]}getDialogOptions(){var e=super.getDialogOptions();return e.width=600,e}initDialog(){var t;super.initDialog();var e=(t=this.domNode.closest(".ui-dialog"))==null?void 0:t.querySelector(".ui-dialog-titlebar-close");e&&(e.style.display="none")}renderContents(){let e=this.useIdPrefix();return P("div",{class:"s-DialogContent s-BasicProgressDialogContent",children:[P("div",{id:e.StatusText,class:"status-text"}),P("div",{id:e.Progress,class:"progress",style:"height: 1.5rem",children:P("div",{id:e.ProgressBar,class:"progress-bar","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100})})]})}};Se=f(mr),H=h(Se,0,"BasicProgressDialog",tt,H),i(H,"BasicProgressDialog"),g(Se,1,H);var re=H;import{confirmDialog as fr,localText as R,notifyError as rt,notifySuccess as gr,notifyWarning as hr,stringFormat as j}from"@serenity-is/corelib";var Ee=class Ee{createProgressDialog(){this.progressDialog=new re({}),this.progressDialog.dialogOpen(),this.progressDialog.max=this.keys.length,this.progressDialog.value=0}getConfirmationFormat(){return R("Site.BulkServiceAction.ConfirmationFormat")}getConfirmationMessage(e){return j(this.getConfirmationFormat(),e)}confirm(e,t){fr(this.getConfirmationMessage(e),t)}getNothingToProcessMessage(){return R("Site.BulkServiceAction.NothingToProcess")}nothingToProcess(){rt(this.getNothingToProcessMessage())}getParallelRequests(){return 1}getBatchSize(){return 1}startParallelExecution(){this.createProgressDialog(),this.successCount=0,this.errorCount=0,this.pendingRequests=0,this.completedRequests=0,this.errorCount=0,this.errorByKey={},this.queue=this.keys.slice(),this.queueIndex=0;for(var e=this.getParallelRequests();e-- >0;)this.executeNextBatch()}serviceCallCleanup(){this.pendingRequests--,this.completedRequests++;var e=R(this.progressDialog.cancelled?"Site.BasicProgressDialog.CancelTitle":"Site.BasicProgressDialog.PleaseWait");e+=" (",this.successCount>0&&(e+=j(R("Site.BulkServiceAction.SuccessCount"),this.successCount)),this.errorCount>0&&(this.successCount>0&&(e+=", "),e+=j(R("Site.BulkServiceAction.ErrorCount"),this.errorCount)),this.progressDialog.title=e+")",this.progressDialog.value=this.successCount+this.errorCount,!this.progressDialog.cancelled&&this.progressDialog.value<this.keys.length?this.executeNextBatch():this.pendingRequests===0&&(this.progressDialog.dialogClose("done"),this.showResults(),this.done&&(this.done(),this.done=null))}executeForBatch(e){}executeNextBatch(){for(var e=this.getBatchSize(),t=[];!(t.length>=e||this.queueIndex>=this.queue.length);)t.push(this.queue[this.queueIndex++]);t.length>0&&(this.pendingRequests++,this.executeForBatch(t))}getAllHadErrorsFormat(){return R("Site.BulkServiceAction.AllHadErrorsFormat")}showAllHadErrors(){rt(j(this.getAllHadErrorsFormat(),this.errorCount))}getSomeHadErrorsFormat(){return R("Site.BulkServiceAction.SomeHadErrorsFormat")}showSomeHadErrors(){hr(j(this.getSomeHadErrorsFormat(),this.successCount,this.errorCount))}getAllSuccessFormat(){return R("Site.BulkServiceAction.AllSuccessFormat")}showAllSuccess(){gr(j(this.getAllSuccessFormat(),this.successCount))}showResults(){if(this.errorCount===0&&this.successCount===0){this.nothingToProcess();return}if(this.errorCount>0&&this.successCount===0){this.showAllHadErrors();return}if(this.errorCount>0){this.showSomeHadErrors();return}this.showAllSuccess()}execute(e){if(this.keys=e,this.keys.length===0){this.nothingToProcess();return}this.confirm(this.keys.length,()=>this.startParallelExecution())}get_successCount(){return this.successCount}set_successCount(e){this.successCount=e}get_errorCount(){return this.errorCount}set_errorCount(e){this.errorCount=e}};i(Ee,"BulkServiceAction");var ot=Ee;import{deepClone as yr,faIcon as xr,postToService as br}from"@serenity-is/corelib";var st;(e=>{function r(t){var o,s;return{hint:(o=t.hint)!=null?o:"Excel",title:(s=t.title)!=null?s:"",cssClass:"export-xlsx-button",icon:xr("file-excel"),onClick:i(function(){if(!t.onViewSubmit())return;let l=t.grid;var u=yr(l.getView().params);u.Take=0,u.Skip=0;var n=l.getView().sortBy;n&&(u.Sort=n),u.ExportColumns=[];let a=l.getGrid().getColumns();for(let p of a)u.ExportColumns.push(p.id||p.field);t.editRequest&&(u=t.editRequest(u)),br({service:t.service,request:u,target:"_blank"})},"onClick"),separator:t.separator}}e.createToolButton=r,i(r,"createToolButton")})(st||(st={}));import{Fluent as it,deepClone as vr,formatDate as nt,resolveUrl as at,serviceCall as Pr,stringFormat as Cr}from"@serenity-is/corelib";var lt;(u=>{function r(n,a,p){return n.map(m=>{let c={dataKey:m.id||m.field,title:m.name||""};p&&p[c.dataKey]!=null&&(c.title=p[c.dataKey]);let C={};return(m.cssClass||"").indexOf("align-right")>=0?C.halign="right":(m.cssClass||"").indexOf("align-center")>=0&&(C.halign="center"),a[c.dataKey]=C,c})}i(r,"toAutoTableColumns");function e(n,a,p,m){var d;let c=document.createElement("span"),C=0,b=(d=n==null?void 0:n.getOptions())==null?void 0:d.sanitizer;return a.map(w=>{var x,D,J;let T=[];for(let O=0;O<m.length;O++){var I=m[O],v=n.getFormatter(C,I),E=n.getFormatterContext(C,O);E.item=w,E.value=w[I.field];let y=v?v(E):"";!y||!(y instanceof Node)&&y.indexOf("<")<0&&y.indexOf("&")<0?T.push(y):(it.empty(c),y instanceof Node?c.appendChild(y):(typeof y=="string"&&y.length&&b&&(y=b(y)),c.innerHTML=y),c.children.length==1&&((x=c.children[0])==null?void 0:x.nodeName)==="SELECT"?T.push((J=(D=c.children[0].querySelector("[selected]"))==null?void 0:D.textContent)!=null?J:""):c.children.length==1&&it.isInputLike(c.children[0])?T.push(c.children[0].value):c.children.length==1&&c.children[0].classList.contains(".check-box")?T.push(c.children[0].classList.contains("checked")?"X":""):T.push(c.textContent||""))}return C++,T})}i(e,"toAutoTableData");function t(n){var a=n.grid;if(n.onViewSubmit()){var p=vr(a.view.params);p.Take=0,p.Skip=0;var m=a.view.sortBy;m!=null&&(p.Sort=m);var c=a.slickGrid.getColumns();c=c.filter(b=>b.id!=="__select__"),p.IncludeColumns=[];for(var C of c)p.IncludeColumns.push(C.id||C.field);Pr({url:a.view.url,request:p,onSuccess:i(b=>l(()=>{let d=new jsPDF("l","pt"),w=c,T={},I=r(w,T,n.columnTitles);var v=I.map(A=>A.dataKey);let E=b.Entities||[],x=e(a.slickGrid,E,v,w);d.setFontSize(n.titleFontSize||10),d.setFont("helvetica","bold");let D=n.reportTitle||a.getTitle()||"Report";d.autoTableText(D,d.internal.pageSize.width/2,n.titleTop||25,{halign:"center"});var J="{{T}}";let O=n.pageNumbers==null||n.pageNumbers;var y=Object.assign({margin:{top:25,left:25,right:25,bottom:O?25:30},startY:60,styles:{fontSize:8,overflow:"linebreak",cellPadding:2,valign:"middle"},columnStyles:T},n.tableOptions),ne,ae;if(O&&(ne=i(function(A){var ce=A.pageCount;typeof d.putTotalPages=="function"&&(ce=ce+" / "+J),d.autoTableText(ce,d.internal.pageSize.width/2,d.internal.pageSize.height-y.margin.bottom,{halign:"center"})},"footer")),(n.printDateTimeHeader==null||n.printDateTimeHeader)&&(ae=i(function(A){d.setFont("helvetica","normal"),d.setFontSize(8),d.autoTableText(nt(new Date,"dd-MM-yyyy HH:mm"),d.internal.pageSize.width-y.margin.right,13,{halign:"right"})},"header")),y.didDrawPage=A=>{ae&&ae(A),ne&&ne(A)},y.head=[I],y.body=x,d.autoTable(y),typeof d.putTotalPages=="function"&&d.putTotalPages(J),!n.output||n.output=="file"){var le=n.fileName||n.reportTitle||"{0}_{1}.pdf";le=Cr(le,a.getTitle()||"report",nt(new Date,"yyyyMMdd_HHmm")),d.save(le);return}n.autoPrint&&d.autoPrint();var ue=n.output;ue=="newwindow",ue="dataurlnewwindow",d.output(ue)}),"onSuccess")})}}u.exportToPdf=t,i(t,"exportToPdf");function o(n){return{title:n.title||"",hint:n.hint||"PDF",cssClass:"export-pdf-button",onClick:i(()=>t(n),"onClick"),separator:n.separator}}u.createToolButton=o,i(o,"createToolButton");function s(n){if(typeof jsPDF!="undefined")return n();var a=document.getElementById("jsPDFScript");if(a)return n();a=document.createElement("script"),a.type="text/javascript",a.async=!1,a.id="jsPDFScript",a.addEventListener("load",()=>{typeof jsPDF=="undefined"&&typeof jspdf!="undefined"&&(window.jsPDF=jspdf.jsPDF),n()}),a.src=at("~/Serenity.Assets/Scripts/jspdf.min.js"),document.head.append(a)}i(s,"includeJsPDF");function l(n){s(()=>{if(typeof jsPDF=="undefined"||typeof jsPDF.API=="undefined"||typeof jsPDF.API.autoTable!="undefined")return n();var a=document.querySelector("#jsPDFAutoTableScript");if(a)return n();a=document.createElement("script"),a.async=!1,a.type="text/javascript",a.id="jsPDFAutoTableScript",a.addEventListener("load",()=>{n()}),a.src=at("~/Serenity.Assets/Scripts/jspdf.plugin.autotable.min.js"),document.head.append(a)})}i(l,"includeAutoTable")})(lt||(lt={}));import{Decorators as Tr,EnumTypeRegistry as Sr,htmlEncode as we,localText as Er,tryGetText as wr}from"@serenity-is/corelib";var ct,De;ct=[Tr.registerFormatter("Serenity.Extensions.EnumSelectFormatter")];var M=class M{constructor(e={}){this.props=e;var t,o,s;(t=this.props)!=null||(this.props={}),(s=(o=this.props).allowClear)!=null||(o.allowClear=!0)}format(e){var u;var t=Sr.get((u=this.props.enumKey)!=null?u:"EnumKeyOptionNotSpecified!"),o="<select>";this.props.allowClear&&(o+='<option value="">',o+=we(this.props.emptyItemText||Er("Controls.SelectEditor.EmptyItemText")),o+="</option>");for(var s of Object.keys(t).filter(n=>!isNaN(parseInt(n,10)))){o+='<option value="'+we(s)+'"',s==e.value&&(o+=" selected");var l=t[s];o+=">",o+=we(wr("Enums."+this.props.enumKey+"."+l)||l),o+="</option>"}return o+="</select>",o}get enumKey(){return this.props.enumKey}set enumKey(e){this.props.enumKey=e}get allowClear(){return this.props.allowClear}set allowClear(e){this.props.allowClear=e}get emptyItemText(){return this.props.emptyItemText}set emptyItemText(e){this.props.emptyItemText=e}};De=f(null),M=h(De,0,"EnumSelectFormatter",ct,M),i(M,"EnumSelectFormatter"),g(De,1,M);var ut=M;import{Decorators as Dr,htmlEncode as Rr,toSingleLine as Ir}from"@serenity-is/corelib";var dt,Re;dt=[Dr.registerFormatter("Serenity.Extensions.SingleLineTextFormatter")];var N=class N{format(e){return N.formatValue(e.value)}static formatValue(e){var t=document.createElement("div");return t.innerHTML=e!=null?e:"",Rr(Ir(t.textContent))}};Re=f(null),N=h(Re,0,"SingleLineTextFormatter",dt,N),i(N,"SingleLineTextFormatter"),g(Re,1,N);var pt=N;import{Decorators as Ie,EntityGrid as Or,IGetEditValue as Ar,ISetEditValue as Lr,deepClone as oe,indexOf as kr}from"@serenity-is/corelib";var ft,Oe,Fr;ft=[Ie.registerClass("Serenity.Extensions.GridEditorBase",[Ar,Lr]),Ie.editor(),Ie.element("<div/>")];var V=class V extends(Fr=Or){constructor(t){super(t);this.nextId=1}getIdProperty(){return"__id"}id(t){return t[this.getIdProperty()]}getNextId(){return"`"+this.nextId++}setNewId(t){t[this.getIdProperty()]=this.getNextId()}save(t,o){var s=t.request,l=oe(s.Entity),u=this.id(l);if(u==null&&(l[this.getIdProperty()]=this.getNextId()),!!this.validateEntity(l,u)){var n=this.view.getItems().slice();if(u==null)n.push(l);else{var a=kr(n,p=>this.id(p)===u);n[a]=oe({},n[a],l)}this.setEntities(n),o({})}}deleteEntity(t){return this.view.deleteItem(t),!0}validateEntity(t,o){return!0}setEntities(t){this.view.setItems(t,!0)}getNewEntity(){return{}}getButtons(){var t=super.getButtons(),o=t.find(s=>s.action==="add");return o&&(o.onClick=()=>{this.createEntityDialog(this.getItemType(),s=>{var l=s;l.onSave=(u,n)=>this.save(u,n),this.transferDialogReadOnly(l),l.loadEntityAndOpenDialog(this.getNewEntity())})}),t.filter(s=>s.action!=="refresh")}editItem(t){var o=t,s=this.view.getItemById(o);this.createEntityDialog(this.getItemType(),l=>{var u=l;u.onDelete=(n,a)=>{this.deleteEntity(o)&&a({})},this.transferDialogReadOnly(u),u.onSave=(n,a)=>this.save(n,a),u.loadEntityAndOpenDialog(s)})}getEditValue(t,o){o[t.name]=this.value}setEditValue(t,o){this.value=t[o.name]}get value(){var t=this.getIdProperty();return this.view.getItems().map(o=>{var s=oe(o),l=s[t];return l&&l.toString().charAt(0)=="`"&&delete s[t],s})}set value(t){var o=this.getIdProperty();this.view.setItems((t||[]).map(s=>{var l=oe(s);return l[o]==null&&(l[o]=this.getNextId()),l}),!0)}getGridCanLoad(){return!1}usePager(){return!1}getInitialTitle(){return null}createQuickSearchInput(){}};Oe=f(Fr),V=h(Oe,0,"GridEditorBase",ft,V),i(V,"GridEditorBase"),g(Oe,1,V);var mt=V;import{Decorators as gt,EntityDialog as qr}from"@serenity-is/corelib";var yt,Ae,Nr;yt=[gt.registerClass("Serenity.Extensions.GridEditorDialog"),gt.panel(!1)];var K=class K extends(Nr=qr){getIdProperty(){return"__id"}destroy(){this.onSave=null,this.onDelete=null,super.destroy()}updateInterface(){super.updateInterface(),this.applyChangesButton&&this.applyChangesButton.hide()}saveHandler(e,t){this.onSave&&this.onSave(e,t)}deleteHandler(e,t){this.onDelete&&this.onDelete(e,t)}};Ae=f(Nr),K=h(Ae,0,"GridEditorDialog",yt,K),i(K,"GridEditorDialog"),g(Ae,1,K);var ht=K;import{Decorators as Hr,BaseDialog as jr,PropertyGrid as Mr,faIcon as Vr,resolveUrl as Kr,serviceCall as Ur}from"@serenity-is/corelib";import{postToUrl as Br}from"@serenity-is/corelib";var se;(t=>{function r(o){var s,l;return{title:(s=o.title)!=null?s:"Report",cssClass:(l=o.cssClass)!=null?l:"print-button",icon:o.icon,onClick:i(()=>{t.execute(o)},"onClick")}}t.createToolButton=r,i(r,"createToolButton");function e(o){var l,u;var s=o.getParams?o.getParams():o.params;Br({url:"~/Serenity.Extensions/Report/"+(o.download?"Download":"Render"),params:{key:o.reportKey,ext:(l=o.extension)!=null?l:"pdf",opt:s?JSON.stringify(s):""},target:(u=o.target)!=null?u:"_blank"})}t.execute=e,i(e,"execute")})(se||(se={}));var xt,Le,Wr;xt=[Hr.registerClass("Serenity.Extensions.ReportDialog")];var U=class U extends(Wr=jr){constructor(e){super(e),this.updateInterface(),this.loadReport(this.options.reportKey)}getDialogButtons(){return null}createPropertyGrid(){this.propertyGrid&&this.byId("PropertyGrid").empty().class(""),this.propertyGrid=new Mr({element:this.byId("PropertyGrid"),idPrefix:this.idPrefix,items:this.report.Properties}).init()}loadReport(e){Ur({url:Kr("~/Serenity.Extensions/Report/Retrieve"),request:{ReportKey:e},onSuccess:i(t=>{this.report=t,this.dialogTitle=this.report.Title,this.createPropertyGrid(),this.propertyGrid.load(this.report.InitialSettings||{}),this.updateInterface(),this.dialogOpen()},"onSuccess")})}updateInterface(){this.toolbar.findButton("print-preview-button").toggle(this.report&&!this.report.IsDataOnlyReport&&!this.report.IsExternalReport),this.toolbar.findButton("run-button").toggle(this.report&&this.report.IsExternalReport),this.toolbar.findButton("export-pdf-button").toggle(this.report&&!this.report.IsDataOnlyReport&&!this.report.IsExternalReport),this.toolbar.findButton("export-xlsx-button").toggle(this.report&&this.report.IsDataOnlyReport&&!this.report.IsExternalReport)}executeReport(e,t,o){if(this.validateForm()){var s={};this.propertyGrid.save(s),se.execute({download:o,reportKey:this.report.ReportKey,extension:t,target:e,params:s})}}getToolbarButtons(){return[{title:"Preview",cssClass:"print-preview-button",onClick:i(()=>this.executeReport("_blank",null,!1),"onClick")},{title:"Run",cssClass:"run-button",icon:Vr("print","blue"),onClick:i(()=>this.executeReport("_blank",null,!1),"onClick")},{title:"PDF",cssClass:"export-pdf-button",onClick:i(()=>this.executeReport("_blank","pdf",!0),"onClick")},{title:"Excel",cssClass:"export-xlsx-button",onClick:i(()=>this.executeReport("_blank","xlsx",!0),"onClick")}]}renderContents(){let e=this.useIdPrefix();return P("div",{class:"s-DialogContent",children:[P("div",{id:e.Toolbar,class:"s-DialogToolbar"}),P("div",{class:"s-Form",children:P("form",{id:e.Form,action:"",children:P("div",{id:e.PropertyGrid})})})]})}};Le=f(Wr),U=h(Le,0,"ReportDialog",xt,U),i(U,"ReportDialog"),g(Le,1,U);var ie=U;import{Decorators as Gr,Fluent as zr,QuickSearchInput as Jr,Widget as Qr,stripDiacritics as bt}from"@serenity-is/corelib";var Pt,ke,Yr;Pt=[Gr.registerClass("Serenity.Extensions.ReportPage")];var W=class W extends(Yr=Qr){constructor(e){super(e),zr.on(this.domNode,"click",".report-link",this.reportLinkClick.bind(this)),new Jr({element:this.domNode.querySelector(".s-QuickSearchBar input"),onSearch:i((t,o,s)=>{this.updateMatchFlags(o),s(!0)},"onSearch")})}updateMatchFlags(e){var t=this.domNode.querySelectorAll(".report-list li");if(t.forEach(a=>a.classList.remove("non-match")),e=e==null?void 0:e.trim(),!e)return;e=bt(e).toUpperCase();var o=Array.from(t).filter(a=>a.classList.contains("report-item"));o.forEach(function(a){var m;var p=bt(((m=a.textContent)!=null?m:"").toUpperCase());p.indexOf(e)<0&&a.classList.add("non-match")});function s(a,p){let m=[];for(;(a=a.parentNode)&&a!==document;)(!p||a.matches(p))&&m.push(a);return m}i(s,"parents");var l=o.filter(a=>!a.classList.contains("non-match")),u=[...l];l.forEach(a=>u.push(...s(a,"li"))),u=u.filter((a,p)=>u.indexOf(a)===p),u.forEach(a=>{a.querySelectorAll(":scope [data-bs-toggle]:not([aria-expanded=true])").forEach(p=>{p.setAttribute("aria-expanded","true"),p.classList.remove("collapsed")}),a.parentElement&&a.parentElement.classList.contains("collapse")&&!a.parentElement.classList.contains("show")&&a.parentElement.classList.add("show")});var n=Array.from(t).filter(a=>u.indexOf(a)<0);n.forEach(a=>a.classList.add("non-match"))}reportLinkClick(e){e.preventDefault(),new ie({reportKey:e.target.getAttribute("data-key")}).dialogOpen()}};ke=f(Yr),W=h(ke,0,"ReportPage",Pt,W),i(W,"ReportPage"),g(ke,1,W);var vt=W;var Fe=class Fe{async getItem(e){return(await Promise.resolve(Z.Retrieve({PreferenceType:"UserPreferenceStorage",Name:e}))).Value}async setItem(e,t){return Promise.resolve(Z.Update({PreferenceType:"UserPreferenceStorage",Name:e,Value:t}))}};i(Fe,"UserPreferenceStorage");var Ct=Fe;import{Dialog as qe,Fluent as Ne,confirmDialog as Xr,isArrayLike as Zr,localText as Tt}from"@serenity-is/corelib";var St;(e=>{function r(t,o){var s=Zr(t)?t[0]:t;if(!s)return;qe.onClose(s,(u,n)=>{u==="save-and-close"||u==="save"||u==="delete"||u==="done"||s.dataset.ackuntil&&new Date().getTime()<parseInt(s.dataset.ackuntil,10)||!o()||(n.preventDefault(),n.stopImmediatePropagation(),Xr(Tt("Site.Dialogs.PendingChangesConfirmation"),()=>{var a;s.dataset.ackuntil=""+new Date().getTime()+1e3,(a=s.querySelector("div.save-and-close-button"))==null||a.click()},{onNo:i(function(){var a;s.dataset.ackuntil=""+new Date().getTime()+1e3,(a=qe.getInstance(s))==null||a.close(u)},"onNo")}))},{before:!0});function l(){if(!(!Ne.isVisibleLike(s)||!o()))return Tt("Site.Dialogs.PendingChangesUnloadWarning")}i(l,"beforeUnload"),Ne.on(window,"beforeunload",l),qe.onClose(s,()=>Ne.off(window,"beforeunload",l),{oneOff:!0})}e.pendingChangesConfirmation=r,i(r,"pendingChangesConfirmation")})(St||(St={}));import{Decorators as $r,PropertyDialog as _r,cancelDialogButton as eo,getTypeFullName as to,okDialogButton as ro,toggleClass as oo}from"@serenity-is/corelib";var wt,Be,so;wt=[$r.registerClass("Serenity.Extensions.PromptDialog")];var B=class B extends(so=_r){constructor(e){if(super(e),this.options.cssClass&&oo(this.domNode,this.options.cssClass),this.options.message){var t=document.createElement("div");t.classList.add("message"),this.byId("PropertyGrid").prepend(t),this.options.isHtml?t.innerHTML=this.options.message:t.textContent=this.options.message}this.dialogTitle=this.options.title||"Prompt"}getDialogButtons(){return[ro({click:i(e=>{if(!this.validateForm()){e.preventDefault();return}this.options.validateValue!=null&&!this.options.validateValue(this.value)&&e.preventDefault()},"click")}),eo()]}loadInitialEntity(){this.value=this.options.value}getPropertyItems(){var e;return[{name:"Value",editorType:typeof this.options.editorType=="function"?to(this.options.editorType):this.options.editorType||"String",required:(e=this.options.required)!=null?e:!0,editorParams:this.options.editorOptions}]}get value(){return this.getSaveEntity().Value}set value(e){this.propertyGrid.load({Value:e})}static prompt(e,t,o,s){new B({title:e,message:t,value:o,validateValue:i(l=>s(l),"validateValue")}).dialogOpen()}};Be=f(so),B=h(Be,0,"PromptDialog",wt,B),i(B,"PromptDialog"),g(Be,1,B);var Et=B;import{Decorators as io,EntityGrid as no}from"@serenity-is/corelib";import{RowSelectionModel as ao}from"@serenity-is/sleekgrid";var Rt,He,lo;Rt=[io.registerClass("Serenity.Extensions.SelectableEntityGrid")];var G=class G extends(lo=no){getSlickOptions(){var e=super.getSlickOptions();return e.enableTextSelectionOnCells=!0,e.selectedCellCssClass="slick-row-selected",e.enableCellNavigation=!0,e}createSlickGrid(){var e=super.createSlickGrid();return e.setSelectionModel(new ao),e}};He=f(lo),G=h(He,0,"SelectableEntityGrid",Rt,G),i(G,"SelectableEntityGrid"),g(He,1,G);var Dt=G;import{Decorators as It,ISetEditValue as uo,Widget as co,localText as po}from"@serenity-is/corelib";var At,je,mo;At=[It.element("<div/>"),It.registerEditor("Serenity.Extensions.StaticTextBlock",[uo])];var z=class z extends(mo=co){constructor(e){var t;if(super(e),this.options.hideLabel){let o=(t=this.domNode.closest(".field"))==null?void 0:t.querySelector(".caption");o&&(o.style.display="none")}this.updateElementContent()}updateElementContent(){var t;var e=(t=this.options.text)!=null?t:this.value;this.options.isLocalText&&(e=po(e)),this.options.isHtml?this.domNode.innerHTML=e:this.domNode.textContent=e}setEditValue(e,t){var o;this.options.text==null&&(this.value=(o=this.options.text)!=null?o:e[t.name],this.updateElementContent())}};je=f(mo),z=h(je,0,"StaticTextBlock",At,z),i(z,"StaticTextBlock"),g(je,1,z);var Ot=z;import{getRemoteDataAsync as fo,localText as _,stringFormat as Lt}from"@serenity-is/corelib";async function go(){return await fo("PasswordStrengthRules")}i(go,"getPasswordStrengthRules");function Vi(r,e){go().then(t=>{r.addValidationRule(()=>{if(r.value.length<t.MinPasswordLength)return Lt(_("Validation.MinRequiredPasswordLength"),t.MinPasswordLength)},e),t.RequireDigit&&r.addValidationRule(()=>{if(!/[0-9]/.test(r.value))return Lt(_("Validation.PasswordStrengthRequireDigit"))},e),t.RequireLowercase&&r.addValidationRule(()=>{if(!/[a-z\p{Ll}]/u.test(r.value))return _("Validation.PasswordStrengthRequireDigit")},e),t.RequireUppercase&&r.addValidationRule(()=>{if(!/[A-Z\p{Lu}]/u.test(r.value))return _("Validation.PasswordStrengthRequireUppercase")},e),t.RequireNonAlphanumeric&&r.addValidationRule(()=>{if(!/[^\s\p{L}]/u.test(r.value))return _("Validation.PasswordStrengthRequireNonAlphanumeric")},e)})}i(Vi,"addPasswordStrengthValidation");export{re as BasicProgressDialog,ot as BulkServiceAction,Je as ChangePasswordForm,St as DialogUtils,ut as EnumSelectFormatter,st as ExcelExportHelper,Qe as ForgotPasswordForm,mt as GridEditorBase,ht as GridEditorDialog,lt as PdfExportHelper,Et as PromptDialog,ie as ReportDialog,se as ReportHelper,vt as ReportPage,Ye as ResetPasswordForm,Dt as SelectableEntityGrid,pt as SingleLineTextFormatter,Ot as StaticTextBlock,Xe as UserPreferenceRow,Z as UserPreferenceService,Ct as UserPreferenceStorage,Vi as addPasswordStrengthValidation,go as getPasswordStrengthRules};
//# sourceMappingURL=index.js.map
